<!doctype html>
<html lang="zh-Hans">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <meta name="description" content="è½»é‡ã€ä½èƒ½è€—ã€ç¯ä¿ä¸»é¢˜çš„ç½‘é¡µç¤ºä¾‹ï¼šèŠ‚èƒ½å»ºè®®ã€è¡ŒåŠ¨æ¸…å•ä¸ç®€æ˜“ç¢³è¶³è¿¹ä¼°ç®—å™¨ã€‚" />
  <title>GreenPulseï½œç¯ä¿ç”Ÿæ´»ï¼Œä»ä»Šå¤©å¼€å§‹</title>

  <!-- æ€§èƒ½å‹å¥½ï¼šç³»ç»Ÿå­—ä½“ï¼Œæ— å¤–é“¾å­—ä½“/åº“ï¼›å°‘é‡ CSSï¼›æ— å¤§å›¾ -->
  <style>
    :root{
      --bg: #0b1220;
      --card: rgba(255,255,255,.06);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --line: rgba(255,255,255,.12);
      --accent: #5eead4;
      --accent2:#a7f3d0;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
      --radius: 18px;
      --max: 1040px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f6faf8;
        --card: rgba(0,0,0,.04);
        --text: rgba(0,0,0,.88);
        --muted: rgba(0,0,0,.62);
        --line: rgba(0,0,0,.12);
        --shadow: 0 10px 28px rgba(0,0,0,.10);
      }
    }
    *{ box-sizing: border-box; }
    html{ scroll-behavior: smooth; }
    body{
      margin:0;
      background: radial-gradient(1200px 700px at 15% 10%, rgba(94,234,212,.18), transparent 55%),
                  radial-gradient(900px 600px at 85% 20%, rgba(167,243,208,.14), transparent 55%),
                  var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB",
                   "Microsoft YaHei", "Noto Sans CJK SC", Arial, sans-serif;
      line-height: 1.6;
    }
    a{ color: inherit; text-decoration: none; }
    a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible{
      outline: 3px solid color-mix(in srgb, var(--accent) 70%, transparent);
      outline-offset: 2px;
      border-radius: 10px;
    }
    .wrap{ max-width: var(--max); margin: 0 auto; padding: 22px 18px 64px; }
    header{
      position: sticky; top: 0; z-index: 10;
      backdrop-filter: blur(10px);
      background: color-mix(in srgb, var(--bg) 82%, transparent);
      border-bottom: 1px solid var(--line);
    }
    .topbar{
      max-width: var(--max); margin: 0 auto; padding: 12px 18px;
      display:flex; align-items:center; justify-content:space-between; gap: 14px;
    }
    .brand{ display:flex; align-items:center; gap: 10px; font-weight: 700; letter-spacing: .2px; }
    .logo{
      width: 34px; height: 34px; border-radius: 12px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: var(--shadow);
      position: relative;
    }
    .logo:before{
      content:"";
      position:absolute; inset: 9px 10px 9px 10px;
      border-radius: 50% 0 50% 50%;
      background: rgba(0,0,0,.20);
      transform: rotate(15deg);
    }
    nav{ display:flex; gap: 14px; flex-wrap: wrap; align-items:center; }
    nav a{
      padding: 8px 10px; border-radius: 12px;
      color: var(--muted);
    }
    nav a:hover{ background: var(--card); color: var(--text); }
    .btn{
      border: 1px solid var(--line);
      background: linear-gradient(135deg, color-mix(in srgb, var(--accent) 22%, transparent), transparent);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      cursor: pointer;
    }
    .btn:hover{ border-color: color-mix(in srgb, var(--accent) 40%, var(--line)); }
    .hero{ padding: 44px 0 22px; display:grid; grid-template-columns: 1.2fr .8fr; gap: 18px; }
    @media (max-width: 900px){ .hero{ grid-template-columns: 1fr; } }
    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .heroMain{ padding: 26px; }
    h1{ margin: 0 0 10px; font-size: clamp(28px, 3.2vw, 44px); line-height: 1.15; }
    .sub{ color: var(--muted); margin: 0 0 18px; font-size: 1.05rem; }
    .pillRow{ display:flex; flex-wrap:wrap; gap: 10px; margin: 16px 0 6px; }
    .pill{
      border: 1px solid var(--line);
      background: color-mix(in srgb, var(--card) 70%, transparent);
      padding: 8px 10px;
      border-radius: 999px;
      font-size: .92rem;
      color: var(--muted);
    }
    .ctaRow{ display:flex; gap: 10px; flex-wrap: wrap; margin-top: 16px; }
    .cta{
      border: 1px solid color-mix(in srgb, var(--accent) 35%, var(--line));
      background: linear-gradient(135deg, color-mix(in srgb, var(--accent) 32%, transparent), transparent);
      padding: 12px 14px; border-radius: 16px; font-weight: 650;
    }
    .cta.secondary{
      background: transparent;
      border-color: var(--line);
      color: var(--muted);
      font-weight: 600;
    }
    .heroSide{ padding: 20px; display:flex; flex-direction: column; gap: 12px; }
    .stat{
      display:flex; justify-content:space-between; align-items:baseline; gap: 12px;
      padding: 14px 14px; border-radius: 16px;
      background: color-mix(in srgb, var(--card) 80%, transparent);
      border: 1px solid var(--line);
    }
    .stat b{ font-size: 1.25rem; }
    .stat span{ color: var(--muted); font-size: .92rem; }
    main{ margin-top: 14px; display:grid; gap: 16px; }
    .grid3{ display:grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    @media (max-width: 920px){ .grid3{ grid-template-columns: 1fr; } }
    .section{ padding: 22px; }
    h2{ margin: 0 0 10px; font-size: 1.35rem; }
    .muted{ color: var(--muted); }
    .list{ margin: 12px 0 0; padding-left: 18px; color: var(--muted); }
    .list li{ margin: 8px 0; }
    .kpi{
      display:grid; gap: 10px;
      grid-template-columns: 1fr 1fr;
      margin-top: 14px;
    }
    @media (max-width: 520px){ .kpi{ grid-template-columns: 1fr; } }
    .kpi .box{
      padding: 14px; border-radius: 16px;
      border: 1px solid var(--line);
      background: color-mix(in srgb, var(--card) 82%, transparent);
    }
    .kpi .box strong{ display:block; font-size: 1.1rem; }
    .form{
      display:grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 14px;
    }
    @media (max-width: 720px){ .form{ grid-template-columns: 1fr; } }
    label{ display:block; font-size: .92rem; color: var(--muted); margin-bottom: 6px; }
    input, select{
      width: 100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: color-mix(in srgb, var(--bg) 84%, transparent);
      color: var(--text);
    }
    .result{
      margin-top: 12px;
      padding: 14px;
      border-radius: 16px;
      border: 1px dashed color-mix(in srgb, var(--accent) 40%, var(--line));
      background: linear-gradient(135deg, color-mix(in srgb, var(--accent) 14%, transparent), transparent);
      color: var(--muted);
    }
    .result b{ color: var(--text); }
    .footer{
      margin-top: 18px;
      padding-top: 18px;
      border-top: 1px solid var(--line);
      color: var(--muted);
      display:flex; justify-content:space-between; gap: 12px; flex-wrap: wrap;
    }
    .sr-only{
      position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0;
    }

    /* å‡å°‘åŠ¨ç”»ï¼šå°Šé‡ç³»ç»Ÿè®¾ç½® */
    @media (prefers-reduced-motion: reduce){
      html{ scroll-behavior: auto; }
      *{ transition: none !important; animation: none !important; }
    }
  </style>
</head>

<body>
<header>
  <div class="topbar" role="navigation" aria-label="ä¸»å¯¼èˆª">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <span>GreenPulse</span>
    </div>
    <nav>
      <a href="#actions">è¡ŒåŠ¨æ¸…å•</a>
      <a href="#calculator">ç®€æ˜“ä¼°ç®—å™¨</a>
      <a href="#design">ç»¿è‰²ç½‘é¡µè®¾è®¡</a>
      <button class="btn" id="toggleMode" type="button" aria-pressed="false" aria-label="åˆ‡æ¢ä¸»é¢˜">
        åˆ‡æ¢ä¸»é¢˜
      </button>
    </nav>
  </div>
</header>

<div class="wrap">
  <section class="hero" aria-labelledby="hero-title">
    <div class="card heroMain">
      <h1 id="hero-title">æŠŠâ€œç¯ä¿â€åšæˆæ—¥å¸¸ï¼šæ›´å°‘æµªè´¹ã€æ›´ä½èƒ½è€—ã€æ›´å¥½ä½“éªŒ</h1>
      <p class="sub">
        è¿™æ˜¯ä¸€ä¸ª<strong>è½»é‡</strong>ã€<strong>æ€§èƒ½å‹å¥½</strong>çš„ç¯ä¿ä¸»é¢˜ç½‘é¡µæ¨¡æ¿ï¼šä¸åŠ è½½å¤–éƒ¨åº“ä¸å­—ä½“ã€é¿å…å¤§å›¾ã€å‡å°‘åŠ¨ç”»ï¼Œ
        è®©ç½‘ç«™æ›´å¿«ã€ä¹Ÿæ›´çœç”µã€‚
      </p>

      <div class="pillRow" aria-label="äº®ç‚¹">
        <span class="pill">ç³»ç»Ÿå­—ä½“</span>
        <span class="pill">æ— å¤–é“¾ä¾èµ–</span>
        <span class="pill">æ— éšœç¢å‹å¥½</span>
        <span class="pill">ä½åŠ¨ç”»ï¼ˆæ”¯æŒå‡å°‘åŠ¨æ€ï¼‰</span>
        <span class="pill">å°‘ JS</span>
      </div>

      <div class="ctaRow">
        <a class="cta" href="#actions">å¼€å§‹å®è·µ</a>
        <a class="cta secondary" href="#design">äº†è§£ç»¿è‰²ç½‘é¡µ</a>
      </div>
    </div>

    <aside class="card heroSide" aria-label="ä»Šæ—¥å°ç›®æ ‡">
      <div class="stat">
        <div>
          <b id="todayTip">ä»Šæ—¥å»ºè®®ï¼šå¸¦æ°´æ¯</b>
          <div class="muted">æ¯å¤©ä¸€ä¸ªå°åŠ¨ä½œ</div>
        </div>
        <span id="tipIndex">01</span>
      </div>

      <div class="stat">
        <div>
          <b id="streak">è¿ç»­æ‰“å¡ï¼š0 å¤©</b>
          <div class="muted">æœ¬åœ°ä¿å­˜ï¼Œä¸ä¸Šä¼ </div>
        </div>
        <span>ğŸŒ¿</span>
      </div>

      <button class="btn" id="checkin" type="button">æˆ‘å·²å®Œæˆä»Šæ—¥ç¯ä¿è¡ŒåŠ¨</button>
      <div class="muted" style="font-size:.92rem;">
        å°æç¤ºï¼šè¿™ä¸ªé¡µé¢ç”¨ <code>localStorage</code> ä¿å­˜æ‰“å¡ä¸ä¸»é¢˜è®¾ç½®ï¼Œä¸éœ€è¦æœåŠ¡å™¨ã€‚
      </div>
    </aside>
  </section>

  <main>
    <section class="card section" id="actions" aria-labelledby="actions-title">
      <h2 id="actions-title">è¡ŒåŠ¨æ¸…å•ï¼ˆé€‰ 3 ä»¶ï¼Œä»æœ€å®¹æ˜“å¼€å§‹ï¼‰</h2>
      <p class="muted">è¶Šå…·ä½“è¶Šå®¹æ˜“åšæŒï¼šæŠŠç›®æ ‡æ”¹æˆâ€œå¯æ‰§è¡Œçš„ä¸€æ­¥â€ã€‚</p>

      <div class="grid3" role="list">
        <div class="card section" role="listitem">
          <h2>å‡ºè¡Œ</h2>
          <ul class="list">
            <li>çŸ­é€”ä¼˜å…ˆæ­¥è¡Œ/éª‘è¡Œï¼›é€šå‹¤å°è¯•å…¬å…±äº¤é€š</li>
            <li>æ‹¼è½¦/åˆä¹˜ï¼Œå‡å°‘å•äººç”¨è½¦</li>
            <li>å‡å°‘â€œç©ºè°ƒè½¦å†…ç­‰äººâ€çš„æ€ é€Ÿæ—¶é—´</li>
          </ul>
        </div>

        <div class="card section" role="listitem">
          <h2>ç”¨ç”µ</h2>
          <ul class="list">
            <li>ç©ºè°ƒæ¸©åº¦ä¸Šè°ƒ 1â„ƒï¼Œä½“æ„Ÿå¯ç”¨é£æ‰‡è¡¥å¿</li>
            <li>å…³é—­å¾…æœºè€—ç”µï¼šä¸ç”¨å°±æ‹”æˆ–å…³æ’åº§</li>
            <li>å°½é‡ç”¨è‡ªç„¶å…‰ï¼›ç¯å…·æ¢ LED</li>
          </ul>
        </div>

        <div class="card section" role="listitem">
          <h2>é¥®é£Ÿä¸æ¶ˆè´¹</h2>
          <ul class="list">
            <li>è‡ªå¸¦æ¯/é¤å…·ï¼›å‡å°‘ä¸€æ¬¡æ€§ç”¨å“</li>
            <li>å‡å°‘é£Ÿç‰©æµªè´¹ï¼šå…ˆæ¸…å†°ç®±å†è´­ç‰©</li>
            <li>ä¼˜å…ˆè€ç”¨å“ã€å¯ç»´ä¿®ã€å°‘åŒ…è£…</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="card section" id="calculator" aria-labelledby="calc-title">
      <h2 id="calc-title">ç®€æ˜“ç¢³æ’ä¼°ç®—å™¨ï¼ˆç”¨äºè‡ªæˆ‘å¯¹æ¯”ï¼Œä¸æ˜¯ä¸¥è°¨æ ¸ç®—ï¼‰</h2>
      <p class="muted">
        ç”¨æœ€å°‘è¾“å…¥åšä¸ªç²—ç•¥ä¼°ç®—ï¼šä½ å¯ä»¥ç”¨å®ƒè§‚å¯Ÿæ”¹å˜å‰åè¶‹åŠ¿ã€‚
      </p>

      <form class="form" id="calcForm">
        <div>
          <label for="kmCar">å¼€è½¦é‡Œç¨‹ï¼ˆæ¯å‘¨ï¼Œå…¬é‡Œï¼‰</label>
          <input id="kmCar" name="kmCar" type="number" min="0" step="1" value="0" inputmode="numeric" />
        </div>
        <div>
          <label for="kwh">ç”¨ç”µé‡ï¼ˆæ¯æœˆï¼ŒkWhï¼‰</label>
          <input id="kwh" name="kwh" type="number" min="0" step="1" value="0" inputmode="numeric" />
        </div>
        <div>
          <label for="meat">çº¢è‚‰æ‘„å…¥ï¼ˆæ¯å‘¨ï¼Œä»½ï¼‰</label>
          <select id="meat" name="meat">
            <option value="0">0 ä»½</option>
            <option value="2">1â€“2 ä»½</option>
            <option value="5">3â€“5 ä»½</option>
            <option value="9">6+ ä»½</option>
          </select>
        </div>
        <div>
          <label for="recycle">æ˜¯å¦è¿›è¡Œåƒåœ¾åˆ†ç±»/å›æ”¶</label>
          <select id="recycle" name="recycle">
            <option value="1">æ˜¯</option>
            <option value="0">å¦</option>
          </select>
        </div>
      </form>

      <div class="result" id="result" aria-live="polite">
        è¯·è¾“å…¥æ•°æ®åï¼Œå°†æ˜¾ç¤ºä½ çš„ä¼°ç®—ç»“æœã€‚
      </div>

      <div class="kpi" aria-label="å»ºè®®">
        <div class="box">
          <strong>æœ€å¿«è§æ•ˆ</strong>
          <div class="muted">æŠŠâ€œæ¯å‘¨å¼€è½¦é‡Œç¨‹â€å‡å°‘ 20%ï¼Œé€šå¸¸æœ€ç›´è§‚ã€‚</div>
        </div>
        <div class="box">
          <strong>æ›´å®¹æ˜“åšæŒ</strong>
          <div class="muted">é€‰ä¸€ä¸ªâ€œæ›¿ä»£åŠ¨ä½œâ€ï¼šå¸¦æ¯/æ­¥è¡Œ 10 åˆ†é’Ÿ/éšæ‰‹å…³ç¯ã€‚</div>
        </div>
      </div>
    </section>

    <section class="card section" id="design" aria-labelledby="design-title">
      <h2 id="design-title">ç»¿è‰²ç½‘é¡µè®¾è®¡è¦ç‚¹ï¼ˆè¿™ä¸ªé¡µé¢å·²å®è·µï¼‰</h2>
      <ul class="list">
        <li><b>å‡å°‘èµ„æºä½“ç§¯ï¼š</b>ä¸ç”¨å¤§å‹æ¡†æ¶ï¼Œå‡å°‘ JSï¼Œåˆå¹¶/ç²¾ç®€ CSSã€‚</li>
        <li><b>é¿å…ä¸å¿…è¦çš„å›¾ç‰‡ä¸è§†é¢‘ï¼š</b>éœ€è¦å›¾ç‰‡æ—¶ä¼˜å…ˆ SVGã€å‹ç¼© WebP/AVIFï¼Œè®¾ç½®åˆç†å°ºå¯¸ã€‚</li>
        <li><b>ç”¨ç³»ç»Ÿå­—ä½“ï¼š</b>é¿å…åŠ è½½å¤šå¥— webfontï¼ˆçœæµé‡ã€çœç”µã€ä¹Ÿæ›´å¿«ï¼‰ã€‚</li>
        <li><b>å°Šé‡ç”¨æˆ·è®¾ç½®ï¼š</b>æ”¯æŒæ·±è‰²æ¨¡å¼ä¸ <code>prefers-reduced-motion</code>ã€‚</li>
        <li><b>æ— éšœç¢ä¸å¯è¯»æ€§ï¼š</b>å¯èšç„¦ã€å¯¹æ¯”åº¦åˆé€‚ã€è¯­ä¹‰åŒ–ç»“æ„ï¼Œå‡å°‘åå¤æ¸²æŸ“ã€‚</li>
      </ul>
    </section>

    <footer class="footer" aria-label="é¡µè„š">
      <div>Â© <span id="year"></span> GreenPulse Â· è½»é‡ç¯ä¿ç½‘é¡µæ¨¡æ¿</div>
      <div>æœ¬é¡µä¸éœ€è¦è”ç½‘å³å¯ä½¿ç”¨ Â· æ•°æ®ä»…ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨</div>
    </footer>
  </main>
</div>

<script>
  // å°‘é‡ JSï¼šä¸»é¢˜åˆ‡æ¢ + æ‰“å¡ + ä¼°ç®—å™¨ï¼ˆæ— å¤–éƒ¨ä¾èµ–ï¼‰
  (function () {
    const $ = (id) => document.getElementById(id);

    // å¹´ä»½
    $("year").textContent = new Date().getFullYear();

    // ä»Šæ—¥ç¯ä¿å°å»ºè®®ï¼ˆå¾ªç¯å±•ç¤ºï¼‰
    const tips = [
      "ä»Šæ—¥å»ºè®®ï¼šå¸¦æ°´æ¯",
      "ä»Šæ—¥å»ºè®®ï¼šå…³æ‰å¾…æœºç”µæº",
      "ä»Šæ—¥å»ºè®®ï¼šæ­¥è¡Œ/éª‘è¡Œ 10 åˆ†é’Ÿ",
      "ä»Šæ—¥å»ºè®®ï¼šè‡ªå¸¦é¤å…·/æ‹’ç»ä¸€æ¬¡æ€§",
      "ä»Šæ—¥å»ºè®®ï¼šå…ˆåƒå®Œå†ä¹°ï¼Œå‡å°‘æµªè´¹",
      "ä»Šæ—¥å»ºè®®ï¼šç©ºè°ƒ+é£æ‰‡ï¼Œæ¸©åº¦ä¸Šè°ƒ 1â„ƒ"
    ];
    const tipIndexKey = "greenpulse_tip_index";
    let tipIndex = Number(localStorage.getItem(tipIndexKey) || "0");
    tipIndex = (tipIndex + 1) % tips.length;
    localStorage.setItem(tipIndexKey, String(tipIndex));
    $("todayTip").textContent = tips[tipIndex];
    $("tipIndex").textContent = String(tipIndex + 1).padStart(2, "0");

    // ä¸»é¢˜åˆ‡æ¢ï¼ˆé€šè¿‡ data-theme æ§åˆ¶ï¼Œé¿å…å¤§é‡é‡ç»˜ï¼‰
    const themeKey = "greenpulse_theme";
    const btn = $("toggleMode");
    function applyTheme(theme) {
      document.documentElement.dataset.theme = theme; // light|dark|auto(ä¸è®¾)
      btn.setAttribute("aria-pressed", theme !== "auto");
    }
    const savedTheme = localStorage.getItem(themeKey) || "auto";
    applyTheme(savedTheme);

    btn.addEventListener("click", () => {
      const cur = localStorage.getItem(themeKey) || "auto";
      const next = cur === "auto" ? "dark" : cur === "dark" ? "light" : "auto";
      localStorage.setItem(themeKey, next);
      applyTheme(next);
      btn.textContent = next === "auto" ? "åˆ‡æ¢ä¸»é¢˜" : (next === "dark" ? "æ·±è‰²æ¨¡å¼" : "æµ…è‰²æ¨¡å¼");
    });

    // æ‰“å¡ï¼šè®°å½•è¿ç»­å¤©æ•°ï¼ˆæœ¬åœ°ï¼‰
    const streakKey = "greenpulse_streak";
    const lastKey = "greenpulse_last_checkin";
    function toDateKey(d) {
      // ä»¥æœ¬åœ°æ—¥æœŸä¸ºå‡†ï¼šYYYY-MM-DD
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      return `${y}-${m}-${day}`;
    }
    function getStreak() { return Number(localStorage.getItem(streakKey) || "0"); }
    function setStreak(n) { localStorage.setItem(streakKey, String(n)); $("streak").textContent = `è¿ç»­æ‰“å¡ï¼š${n} å¤©`; }
    function initStreak(){ setStreak(getStreak()); }
    initStreak();

    $("checkin").addEventListener("click", () => {
      const today = new Date();
      const todayKey = toDateKey(today);
      const last = localStorage.getItem(lastKey);

      if (last === todayKey) return; // ä»Šå¤©å·²æ‰“å¡ï¼Œä¸é‡å¤åŠ 

      // è®¡ç®—æ˜¯å¦è¿ç»­ï¼ˆæ˜¨å¤©ï¼‰
      const y = new Date(today);
      y.setDate(today.getDate() - 1);
      const yKey = toDateKey(y);

      let s = getStreak();
      s = (last === yKey) ? (s + 1) : 1;

      localStorage.setItem(lastKey, todayKey);
      setStreak(s);
    });

    // ç®€æ˜“ä¼°ç®—å™¨ï¼ˆéå¸¸ç²—ç•¥ï¼Œä»…ç”¨äºå¯¹æ¯”è¶‹åŠ¿ï¼‰
    // å‚è€ƒç³»æ•°ï¼ˆç¤ºä¾‹å€¼ï¼‰ï¼šæ±½è½¦ 0.2 kgCO2/kmï¼›ç”µåŠ› 0.5 kgCO2/kWhï¼›çº¢è‚‰æ¯ä»½ 2 kgCO2ï¼ˆä»…ç¤ºæ„ï¼‰
    const factors = { car: 0.20, power: 0.50, meat: 2.0 };
    function calc() {
      const kmCar = Math.max(0, Number($("kmCar").value || 0));
      const kwh = Math.max(0, Number($("kwh").value || 0));
      const meat = Math.max(0, Number($("meat").value || 0));
      const recycle = Number($("recycle").value || 1);

      const carKg = kmCar * factors.car;
      const powerKg = kwh * factors.power;
      const meatKg = meat * factors.meat;

      // å›æ”¶ä½œä¸ºâ€œå‡æ’ç³»æ•°â€ç¤ºæ„ï¼šæœ‰å›æ”¶åˆ™æ€»é‡å‡å°‘ 3%
      const total = (carKg + powerKg + meatKg) * (recycle ? 0.97 : 1.00);

      // ç»™å‡ºä¸€ä¸ªâ€œä¸‹ä¸€æ­¥å»ºè®®â€
      let suggestion = "ä»æœ€å®¹æ˜“çš„ 1 ä»¶äº‹å¼€å§‹ï¼šå¸¦æ¯/å…³å¾…æœº/å°‘å¼€è½¦ã€‚";
      if (kmCar > 50) suggestion = "ä¼˜å…ˆå‡å°‘å¼€è½¦é‡Œç¨‹ï¼šæ¯å‘¨å°‘ 10km å°±å¾ˆå¯è§‚ã€‚";
      else if (kwh > 200) suggestion = "ä¼˜å…ˆä¼˜åŒ–ç”¨ç”µï¼šç©ºè°ƒæ¸©åº¦ä¸Šè°ƒ 1â„ƒ + é£æ‰‡ã€‚";
      else if (meat >= 5) suggestion = "ä¼˜å…ˆä»é¥®é£Ÿå…¥æ‰‹ï¼šç”¨è±†åˆ¶å“/é¸¡è›‹æ›¿ä»£ä¸€éƒ¨åˆ†çº¢è‚‰ã€‚";

      $("result").innerHTML =
        `ä½ çš„ä¼°ç®—ç¢³æ’ï¼š<b>${total.toFixed(1)} kgCOâ‚‚e</b>ï¼ˆç¤ºæ„å€¼ï¼‰<br>` +
        `æ„æˆï¼šå¼€è½¦ <b>${carKg.toFixed(1)}</b> / ç”¨ç”µ <b>${powerKg.toFixed(1)}</b> / çº¢è‚‰ <b>${meatKg.toFixed(1)}</b><br>` +
        `<span class="muted">å»ºè®®ï¼š${suggestion}</span>`;
    }

    ["kmCar","kwh","meat","recycle"].forEach(id => {
      $(id).addEventListener("input", calc);
      $(id).addEventListener("change", calc);
    });
    calc();

    // å¯é€‰ï¼šé€šè¿‡ data-theme å¼ºåˆ¶ä¸»é¢˜ï¼ˆauto æ—¶ä¸è®¾ç½®ï¼‰
    const observer = new MutationObserver(() => {
      const t = document.documentElement.dataset.theme;
      if (!t || t === "auto") {
        document.documentElement.style.colorScheme = "light dark";
        document.documentElement.removeAttribute("data-force-theme");
      } else {
        document.documentElement.style.colorScheme = t;
      }
    });
    observer.observe(document.documentElement, { attributes: true, attributeFilter: ["data-theme"] });
  })();
</script>
</body>
</html>
